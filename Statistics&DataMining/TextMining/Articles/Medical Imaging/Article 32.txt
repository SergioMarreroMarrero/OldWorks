Automatic Deformable MR-Ultrasound Registration for Image-Guided Neurosurgery,

# In this work, we present a novel algorithm for registration of 3-D volumetric ultrasound (US) and MR using Robust PaTch-based cOrrelation Ratio (RaPTOR). RaPTOR computes local correlation ratio (CR) values on small patches and adds the CR values to form a global cost function. It is therefore invariant to large amounts of spatial intensity inhomogeneity. We also propose a novel outlier suppression technique based on the orientations of the RaPTOR gradients. Our deformation is modeled with free-form cubic B-splines. We analytically derive the derivatives of RaPTOR with respect to the transformation, i.e., the displacement of the B-spline nodes, and optimize RaPTOR using a stochastic gradient descent approach. RaPTOR is validated on MR and tracked US images of neurosurgery. Deformable registration of the US and MR images acquired, respectively, preoperation and postresection is of significant clinical significance, but challenging due to, among others, the large amount of missing correspondences between the two images. This work is also novel in that it performs automatic registration of this challenging dataset. To validate the results, we manually locate corresponding anatomical landmarks in the US and MR images of tumor resection in brain surgery. Compared to rigid registration based on the tracking system alone, RaPTOR reduces the mean initial mTRE over 13 patients from 5.9 to 2.9 mm, and the maximum initial TRE from 17.0 to 5.9 mm. Each volumetric registration using RaPTOR takes about 30 sec on a single CPU core. An important challenge in the field of medical image analysis is the shortage of publicly available dataset, which can both facilitate the advancement of new algorithms to clinical settings and provide a benchmark for comparison. To address this problem, we will make our manually located landmarks available online.

{biomedical MRI;biomedical ultrasonics;brain;image registration;medical image processing;neurophysiology;splines (mathematics);surgery;tumours;3D volumetric ultrasound;MR images;automatic deformable MR-ultrasound registration;brain surgery;free-form cubic B-splines;image registration;image-guided neurosurgery;medical image analysis;outlier suppression technique;rigid registration;robust patch-based correlation ratio;tumor resection;volumetric registration;Biomedical imaging;Correlation;Measurement;Nonhomogeneous media;Optimization;Robustness;Tumors;Brain surgery;IGNS;image guided neurosurgery;intraoperative ultrasound;nonrigid registration;online database;validation database},



